<div class="contentWrapper">
	<ng-container *ngIf="contentSubject | async as contentObject; else unavailable">
		<!-- if the content exists and you're authorized, the contnet will be a valid object; else not. -->
		<ng-container *ngIf="contentObject && contentObject.content !== undefined; else unavailable">
			<h1>{{contentObject.title || "[Blank]"}}</h1>
			<div *ngIf="(authService.getUser() | async) && authService.isUserOfRole(AccessRoles.admin) && !previewMode" class="pageControls">
				<button mat-icon-button [matMenuTriggerFor]="pageControls">
					<mat-icon>more_vert</mat-icon>
				</button>
				<mat-menu #pageControls="matMenu" xPosition="before">
					<button mat-menu-item (click)="editPage()">
						<mat-icon>mode_edit</mat-icon> Edit
					</button>
					<button mat-menu-item (click)="deletePage()" [disabled]="contentObject.route === 'home'">
						<mat-icon>delete</mat-icon> Delete
					</button>
				</mat-menu>
			</div>
			<div>
				<!-- The actual content will be injected here -->
				<div #contentHost class="content"></div>
				<!-- End of content -->

				<span class="info" *ngIf="contentObject.access !== AccessRoles.everyone">Access group: {{contentObject.access}}</span>
				<div class="info right" *ngIf="contentObject.route !== 'home' && !previewMode">
					<div>
						Updated by: {{contentObject.updatedBy.username}}, <span [matTooltip]="contentObject.updatedAt | TimeAgo" matTooltipPosition="above">
							{{ contentObject.updatedAt | date:'dd. MMM yyyy, HH:mm' }}
						</span>
					</div>
					<div>
						Written by: {{contentObject.createdBy.username}}, <span [matTooltip]="contentObject.createdAt | TimeAgo" matTooltipPosition="above">
							{{ contentObject.createdAt | date:'dd. MMM yyyy, HH:mm' }}
						</span>
					</div>
				</div>
			</div>
		</ng-container>
	</ng-container>

	<!-- The content is unavailable or doesn't exist -->
	<ng-template #unavailable>
		<h1>Page at /{{ (route.url | async).join('/') }}</h1>
		<h2>Page not available</h2>
		<div>
			<div class="content">
				<p>
					This page seems to be unavailable at the moment. Maybe you're not authorized, or maybe the network is flaky.
					It could even be that the page you attempted to access does not actually exist.
				</p>
				<p>
					Either way; it wasn't meant to be, right now.
				</p>
			</div>
		</div>
	</ng-template>
</div>
